/**
 * g2.chart (c) 2015-16 Stefan Goessner
 * @license
 * MIT License
 */
if(this.require!==undefined)g2=require("./g2.js");var g2=g2||{prototype:{}};g2.prototype.chart=function t(i){var s=Object.getPrototypeOf(i)===g2.Chart.prototype?i:g2.Chart.create(i);return s.draw(this)};g2.Chart={create:function(){var t=Object.create(this.prototype);t.constructor.apply(t,arguments);return t},prototype:{constructor:function(t){var i;if(t)Object.assign(this,t);if(this.funcs&&this.funcs.length){for(var s=0;s<this.funcs.length;s++)this.initFunc(this.funcs[s],this.xmin===undefined,this.xmax===undefined,this.ymin===undefined,this.ymax===undefined)}if(this.xmin!==undefined&&this.xmax!==undefined)this.xAxis=g2.Chart.AutoAxis.create(this.xmin,this.xmax,0,this.b);if(this.ymin!==undefined&&this.ymax!==undefined)this.yAxis=g2.Chart.AutoAxis.create(this.ymin,this.ymax,0,this.h)},get:function(t,i,s,e){var h=e?this[t]&&this[t][i]&&this[t][i][s]&&this[t][i][s][e]:s?this[t]&&this[t][i]&&this[t][i][s]:i?this[t]&&this[t][i]:t?this[t]:undefined;return h!==undefined?h:e?g2.Chart[t]&&g2.Chart[t][i]&&g2.Chart[t][i][s]&&g2.Chart[t][i][s][e]:s?g2.Chart[t]&&g2.Chart[t][i]&&g2.Chart[t][i][s]:i?g2.Chart[t]&&g2.Chart[t][i]:t?g2.Chart[t]:undefined},initFunc:function(t,i,s,e,h){var a;if(t.data&&t.data.length){a=t.itr=g2.prototype.ply.itrOf.call(null,t.data)}else if(t.fn&&!i&&!s&&t.dx){var n=this;a=t.itr=function(i){var s=n.xmin+i*t.dx;return{x:s,y:t.fn(s)}};a.len=(this.xmax-this.xmin)/t.dx+1}if(a){var x=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,f=Number.NEGATIVE_INFINITY,y;for(var o=0,c=a.len;o<c;o++){y=a(o);if(y.x<x)x=y.x;if(y.y<r)r=y.y;if(y.x>l)l=y.x;if(y.y>f)f=y.y}t.xmin=x;t.xmax=l,t.ymin=r,t.ymax=f;if(i&&(this.xmin===undefined||x<this.xmin))this.xmin=x;if(s&&(this.xmax===undefined||l<this.xmax))this.xmax=l;if(e&&(this.ymin===undefined||r<this.ymin))this.ymin=r;if(h&&(this.ymax===undefined||f<this.ymax))this.ymax=f}},valOf:function(t){return t},pixOf:function(t){return{x:this.x+(t.x-this.xAxis.zmin)*this.xAxis.scl,y:this.y+(t.y-this.yAxis.zmin)*this.yAxis.scl}},trimPixOf:function(t){return{x:this.x+Math.max(Math.min((t.x-this.xAxis.zmin)*this.xAxis.scl,this.b),0),y:this.y+Math.max(Math.min((t.y-this.yAxis.zmin)*this.yAxis.scl,this.h),0)}},draw:function(t){var i=this.title,s=this.get("funcs");t.rec(this.x,this.y,this.b,this.h,this.get("style"));t.beg(Object.assign({x:this.x,y:this.y},g2.Chart.style,this.style));if(i)t.txt(i.text||i,this.b/2,this.h+this.get("title","offset"),0,Object.assign({},g2.Chart.title.style,this.title&&this.title.style));this.drawXAxis(t);this.drawYAxis(t);t.end();if(s&&s.length)for(var e=0;e<s.length;e++)this.drawFunc(t,s[e],g2.Chart.func.color[e]);return t},drawFunc:function(t,i,s){var e=[],h=i.itr,a=i.fill||i.style&&i.style.fs&&i.style.fs!=="transparent",n=Object.assign({},g2.Chart.func.style,a?{ls:s,fs:s[0]==="#"?g2.Chart.semiTransparentOf(s):s}:{ls:s},i.style);if(h){if(a)e.push(this.trimPixOf({x:h(0).x,y:0}));for(var x=0,r=h.len;x<r;x++)e.push(this.trimPixOf(h(x)));if(a)e.push(this.trimPixOf({x:h(h.len-1).x,y:0}));if(i.spline)t.spline(e,false,n);else t.ply(e,false,n);if(i.dots){t.beg({fs:"snow"});for(var x=0;x<e.length;x++)t.cir(e[x].x,e[x].y,3);t.end()}}},drawXAxis:function(t){var s,e=this.xaxis&&this.xaxis.grid,h=e?Object.assign({},g2.Chart.xaxis.grid,this.xaxis.grid):null,a=this.xaxis||this.xAxis,x=a&&Object.assign({},g2.Chart.xaxis.style,g2.Chart.xaxis.labels.style,this.xaxis&&this.xaxis.style),r=a&&this.get("xaxis","line"),l=this.xAxis&&a&&this.get("xaxis","labels"),f=this.xAxis&&a&&this.get("xaxis","ticks"),y=f?this.get("xaxis","ticks","len"):0,o=a&&this.get("xaxis","origin"),c=this.xaxis&&this.xaxis.title,g=this.xAxis&&this.xAxis.itr();t.beg(x);for(i=0,n=g&&g.len;i<n;i++){s=g(i);if(f)t.lin(s.t,0,s.t,s.maj?-y:-2/3*y);if(e)t.lin(s.t,0,s.t,this.h,h);if(o&&s.z===0)t.lin(s.t,0,s.t,this.h);if(l&&s.maj)t.txt(s.z,s.t,-(this.get("xaxis","ticks","len")+this.get("xaxis","labels","offset")),0,Object.assign({},g2.Chart.xaxis.labels.style,this.xaxis&&this.xaxis.labels&&this.xaxis.labels.style))}if(r)t.lin(0,0,this.b,0);if(c){t.txt(c.text||c,this.b/2,-(this.get("xaxis","title","offset")+(f&&this.get("xaxis","ticks","len")||0)+(l&&this.get("xaxis","labels","offset")||0)+(l&&this.get("xaxis","labels","style","foz")||0)),0,Object.assign({},g2.Chart.xaxis.title.style,this.xaxis&&this.xaxis.title&&this.xaxis.title.style))}t.end()},drawYAxis:function(t){var s,e=this.yaxis&&this.yaxis.grid,h=e?Object.assign({},g2.Chart.yaxis.grid,this.yaxis.grid):null,a=this.yaxis||this.yAxis,x=a&&Object.assign({},g2.Chart.yaxis.style,g2.Chart.yaxis.labels.style,this.yaxis&&this.yaxis.style),r=a&&this.get("yaxis","line"),l=this.yAxis&&this.get("yaxis","labels"),f=this.yAxis&&this.get("yaxis","ticks"),y=f?this.get("yaxis","ticks","len"):0,o=a&&this.get("yaxis","origin"),c=this.yaxis&&this.yaxis.title,g=this.yAxis&&this.yAxis.itr();t.beg(x);for(i=0,n=g&&g.len;i<n;i++){s=g(i);if(f)t.lin(0,s.t,s.maj?-y:-2/3*y,s.t);if(e)t.lin(0,s.t,this.b,s.t,h);if(o&&s.z===0)t.lin(0,s.t,this.b,s.t);if(l&&s.maj)t.txt(s.z,-(this.get("yaxis","ticks","len")+this.get("yaxis","labels","offset")),s.t,Math.PI/2)}if(r)t.lin(0,0,0,this.h);if(c)t.txt(c.text||c,-(this.get("yaxis","title","offset")+(f&&this.get("yaxis","ticks","len")||0)+(l&&this.get("yaxis","labels","offset")||0)+(l&&this.get("yaxis","labels","style","foz")||0)),this.h/2,Math.PI/2,Object.assign({},g2.Chart.yaxis.title.style,this.yaxis&&this.yaxis.title&&this.yaxis.title.style));t.end()}},AutoAxis:{create:function(){var t=Object.create(this.prototype);t.constructor.apply(t,arguments);return t},prototype:{constructor:function(t,i,s,e){var h=2,a=1,n=Math.sqrt(Number.EPSILON),x,r,l=i-t||1,f=e-s||1,y=l>n?f/l:1;while((x=y*h*Math.pow(10,a))<14||x>35){if(x<14){if(h==1)h=2;else if(h==2)h=5;else if(h==5){h=1;a++}}else{if(h==1){h=5;a--}else if(h==2)h=1;else if(h==5)h=2}}r=Math.abs(t*y%x);r=r<n||x-r<n?0:r;this.scl=y;this.zmin=t;this.dz=l;this.tmin=s;this.dt=f;this.exp=a;this.dtick=x;this.jth=h===2?5:2;this.i0=t>=0||r===0?Math.floor(t*y/x):Math.floor(t*y/x+1);this.z0=this.i0*x/y;this.t0=Math.floor(r)},get zmax(){return this.zmin+this.dz},get tmax(){return this.tmin+this.dt},itr:function(){var t=this;function i(i){var s=t.t0+i*t.dtick;return{t:t.t0+i*t.dtick,z:Math.round((t.i0+i)*t.dtick/t.scl*Math.pow(10,-t.exp))*Math.pow(10,t.exp),maj:(t.i0+i)%t.jth===0}}i.len=Math.floor((this.dt-this.t0)/this.dtick+1);return i}}},semiTransparentOf:function(t){var i=parseInt(t.substring(1),16);return"rgba("+((i&16711680)>>16)+","+((i&65280)>>8)+","+(i&255)+",0.5)"},style:{ls:"transparent",fs:"#efefef"},title:{text:null,offset:3,style:{foc:"#000",foz:16,thal:"center",tval:"bottom"}},funcs:[],func:{style:{lw:1,fs:"transparent"},color:["#426F42","#8B2500","#23238E","#5D478B"]},xaxis:{line:true,style:{ls:"#888",thal:"center",tval:"top",foc:"black"},origin:false,title:{text:null,offset:1,style:{foz:12}},ticks:{len:6},grid:{ls:"#ddd",ld:[]},labels:{loc:"auto",offset:1,style:{foz:11}}},yaxis:{line:true,style:{ls:"#888",thal:"center",tval:"bottom",foc:"black"},origin:false,title:{text:null,offset:2,style:{foz:12}},ticks:{len:6},grid:{ls:"#ddd",ld:[]},labels:{loc:"auto",offset:1,style:{foz:11}}}};